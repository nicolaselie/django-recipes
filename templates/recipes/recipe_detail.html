{% extends "recipes/base.html" %}
{% load staticfiles %}
{% load ratings_tags %}
{% load duration %}

{% block title %}{{ recipe.title }}{% endblock %}

{% block content %}
    {% if recipe.picture %}
    <div id="picture">
        <a href="{{ recipe.picture.url }}" ><img alt="Photo" src="{{ recipe.picture.preview.url }}" /></a>
    </div>
    {% endif %}
    
    
    <div id="meta">
        {% if recipe.preparation_time %}<p><span class="cookingsymbol">g</span>{{ recipe.preparation_time|naturalduration }}</p>{% endif %}
        {% for bakinginfo in recipe.bakinginfo_set.all %}
        <p><span class="cookingsymbol">{{ bakinginfo.type }}</span>{{ bakinginfo.time|naturalduration }}, <span class="cookingsymbol">t</span>{{ bakinginfo.temperature }}{{ bakinginfo.get_unit_display }}</p>
        {% endfor %}
        {% if recipe.portion %}<p><span class="cookingsymbol">d</span>{{ recipe.portion }}</p>{% endif %}
        <p>
            <span class="cookingsymbol">p</span> 
            {% for source in recipe.sources.all %}<a href="{% url 'recipes_by_source' source=source.slug %}">{{ source.name }}</a>{% if forloop.counter < recipe.sources.all|length %},&nbsp;{% endif %}{% endfor %}
        </p>
        <p><span id="rating" data-number="5" data-score="{{ recipe.ratings.average_score }}" data-path="{% static '' %}" data-rate-url="{{ recipe|rate_url:0 }}" data-unrate-url="{{ recipe|unrate_url }}"></span></p>    
    </div>

    <div id="ingredients">
        <p class="section-title">Ingrédients</p>
        {{ recipe.ingredients_markup|safe }}
    </div>
    
    <div id="recipe">
        <p class="section-title">Préparation</p>
        {{ recipe.content_markup|safe }}
    </div>
    
    {% if recipe.hint %}
    <div id="hint">
        <p>Astuce</p>
        {{ recipe.hint }}
    </div>
    {% endif %}    
{% endblock %}